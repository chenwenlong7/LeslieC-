# 框架设计概览

## 1、权衡的艺术

> 框架设计里到处都体现了权衡的艺术

### 1-1、命令式和声明式

命令式--命令式框架的一大特点就是关注过程

````javascript
//获取id为app的div标签
//它的文本内容为 hello world
//为其绑定点击事件
//当点击时弹出提示： ok
````

对应的代码为：

````javascript
$('#app')
	.text('hello world')  //设置文本内容
	.on('click', () => { alert('ok') }) //绑定点击事件
````

以上就是jQuery的代码示例， 此处再使用原生javascript实现同样的功能：

````javascript
const div = document.querySelector('#app') //获取div
div.innerText = 'hello world' //设置文本内容
div.addEventListener('click', () => { alert('ok') }) //绑定点击事件
````

声明式--与命令式框架更关注过程不同，声明式框架更加**关注结果**。结合vue.js，我们来看看如何实现上面自然语言描述的功能：

````vue
<div @click="() => alert('ok')">hello world</div>
````

这段类HTML的模版就是Vue.js实现如上功能的方式。换句话说Vue.js帮我们封装了**过程**。因此，我们能够猜到Vue.js的内部实现一定是**命令式**的，而暴露给用户的却更加**声明式**。

### 1-2、性能与可维护性的权衡

命令式和声明式各有优缺点，在框架设计方面，则体现在性能和可维护性之间的的权衡。这里我们先抛出一个结论：**声明式代码的性能不优于命令式代码的性能。**

> 尤雨溪在知乎上也发表过类似的评论

 [尤雨溪的回答](https://www.zhihu.com/question/31809713/answer/53544875)

由此我们也可以得出来一个简单的公式即：

**声明式代码的更新性能消耗 = 找出差异的性能消耗 + 直接修改的性能消耗。**


### 总结

虚拟DOM的意义就在于使找出差异的性能消耗最小化。我们发现，用原生javascript操作DOM的方法(如documen.createElement)、虚拟DOM和innerHTML三者操作页面的性能，不可以简单的下定论，这与**页面大小、变更部分的大小**都有关系，除此之外，与**创建页面**还是**更新页面**也有关系，选择哪种更新策略，需要我们结合**心智负担、可维护性**等因素综合考虑。一番权衡之后，我们发现虚拟DOM是个还不错的选择。
	

我们也知道了Vue.js3是一个纯编译时 + 运行时的框架，它在保持灵活性的基础上，还能通过编译手段分析用户提供的内容，从而进一步提升更新性能。

